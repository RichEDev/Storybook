!function () { function b() { SEL.registerNamespace("SEL.Logon"), SEL.Logon = { ModalWindowDomID: null, ModalForgottenDetailsMessageDomID: null, ModalForgottenDetailsEmailAddressDomID: null, ModalForgottenDetailsSubmitSpanDomID: null, ModalForgottenDetailsCloseSpanDomID: null, FlashForgottenDetailsButton: !1, CompanyIDDomID: null, UsernameDomID: null, PasswordDomID: null, HostName: null, OriginalButtonBorderColour: null, OriginalButtonTextColour: null, ModalMessageEmailNotUnique: "Sorry, the email address you have entered is not unique so your logon details cannot be sent there. Please call your administrator for assistance.", ModalMessageEmailNotFound: "Sorry, the email address you have entered does not exist.  Please call your administrator for assistance.", ModalMessageArchivedEmployee: "Your account is currently archived, please call your administrator to un-archive your account and reset your password.", ModalMessageInactiveEmployee: "Your account is currently waiting to be approved, please call your administrator to have your account activated.", ModalMessageEmployeeDetailsSent: "Thank you, you will shortly receive an email with instructions on how to reset your password.", ModalMessageEmployeeLocked: "Your account is currently locked, please call your administrator to unlock your account and reset your password.", ForgottenDetailResponse: { 1: SEL.Logon.ModalMessageEmailNotUnique, 2: SEL.Logon.ModalMessageEmailNotFound, 3: SEL.Logon.ModalMessageArchivedEmployee, 4: SEL.Logon.ModalMessageInactiveEmployee, 5: SEL.Logon.ModalMessageEmployeeDetailsSent, 6: SEL.Logon.ModalMessageEmployeeLocked }, HideForgottenDetails: function () { $("#forgottenDetailsPanel").hide(); var a = $("#lnkForgottenDetails"); a.finish(), a.removeAttr("style"), a.attr("href", "#forgottendetails"), a.attr("title", "forgotten details"), a.children("span").text("forgotten details"), a.button().off("click").on("click", function () { return SEL.Logon.ShowForgottenDetails(), !1 }), $("#logonPanel").fadeIn(), $g(SEL.Logon.ModalForgottenDetailsEmailAddressDomID).value = "", $g(SEL.Logon.ModalForgottenDetailsMessageDomID).innerHTML = "" }, PromptForgottenDetails: function () { var a = $("#lnkForgottenDetails"); this.OriginalButtonBorderColour = a.css("border-top-color"), this.OriginalButtonTextColour = a.css("color"); var b = 600, c = "#F00"; $("#lnkForgottenDetails").animate({ borderColor: c, color: c }, b).animate({ borderColor: this.OriginalButtonBorderColour, color: this.OriginalButtonTextColour }, b).animate({ borderColor: c, color: c }, b).animate({ borderColor: this.OriginalButtonBorderColour, color: this.OriginalButtonTextColour }, b).animate({ borderColor: c, color: c }, b).animate({ borderColor: this.OriginalButtonBorderColour, color: this.OriginalButtonTextColour }, b).animate({ borderColor: c }, b) }, ShowForgottenDetails: function () { $("#logonPanel").hide(); var a = $("#lnkForgottenDetails"); a.finish(), a.removeAttr("style"), a.attr("href", "#"), a.attr("title", "logon"), a.children("span").text("logon"), a.button().off("click").on("click", function () { return SEL.Logon.HideForgottenDetails(), !1 }), $("#forgottenDetailsPanel").fadeIn() }, SubmitForgottenDetails: function () { SEL.Common.ValidateForm("ForgottenDetails", SEL.Logon.ModalForgottenDetailsMessageDomID) === !0 && Spend_Management.svcLogon.RequestForgottenDetails($g(SEL.Logon.ModalForgottenDetailsEmailAddressDomID).value, SEL.Logon.HostName, SEL.Logon.SubmitComplete, SEL.Logon.SubmitFail) }, SubmitComplete: function (a) { var b = ""; switch (parseInt(a, 0)) { case 1: b = SEL.Logon.ModalMessageEmailNotUnique; break; case 2: b = SEL.Logon.ModalMessageEmailNotFound; break; case 3: b = SEL.Logon.ModalMessageArchivedEmployee; break; case 4: b = SEL.Logon.ModalMessageInactiveEmployee; break; case 5: b = SEL.Logon.ModalMessageEmployeeDetailsSent; break; case 6: b = SEL.Logon.ModalMessageEmployeeLocked; break; default: b = SEL.Common.MessageGenericError } $g(SEL.Logon.ModalForgottenDetailsMessageDomID).innerHTML = b }, SubmitFail: function (a) { $g(SEL.Logon.ModalForgottenDetailsMessageDomID).innerHTML = SEL.Common.MessageGenericError }, SetLogonControlFocus: function () { null !== $g(SEL.Logon.CompanyIDDomID) && null !== $g(SEL.Logon.UsernameDomID) && null !== $g(SEL.Logon.PasswordDomID) && ("" === $g(SEL.Logon.CompanyIDDomID).value ? $g(SEL.Logon.CompanyIDDomID).focus() : "" === $g(SEL.Logon.UsernameDomID).value ? $g(SEL.Logon.UsernameDomID).focus() : $g(SEL.Logon.PasswordDomID).focus()) }, ReInitializeWrapper: function (a) { $(window).width() <= 1280 || $(window).width() < 1520 && $(window).height() > 801 ? $(".sliderImage").addClass("sliderImage-resize") : $(".sliderImage").removeClass("sliderImage-resize"), $(window).width() <= 1024 || $("#bxSlider li").length < 1 ? ("undefined" != typeof a && a.destroySlider(), $("#right").hide(), $("#left").removeClass("left-wrapper")) : ($("#right").show(), $("#left").addClass("left-wrapper"), "undefined" != typeof a && a.reloadSlider()), $(".slider-container-ie .bx-viewport").attr("style", "height:" + $(window).height() + "px !important").addClass("slider-container-ie"), SEL.Logon.AlignModals() }, AlignModals: function () { var a = ($("#left").width() - $("#modal-panel").width()) / 2; $("#modal-panel").css("margin-left", a - 5 + "px"), a = ($("#left").height() - $("#logonTopPanel").height()) / 2, $("#modal-panel").css("margin-top", a + "px") }, PreviewRequestHandler: function () { $("#btnLogon").click(function (a) { a.preventDefault() }), $("#lnkSelfRegistration").attr("onclick", "return false;"), $("#lnkForgottenDetails").unbind("click"); var a = sessionStorage.getItem("iconForTitle"), b = sessionStorage.getItem("LogonCategoryTitle"), c = sessionStorage.getItem("LogonCategoryTitleColor"), d = sessionStorage.getItem("LogonHeader"), e = sessionStorage.getItem("LogonHeaderColor"), f = sessionStorage.getItem("LogonBody"), g = sessionStorage.getItem("LogonBodyColor"), h = sessionStorage.getItem("backGroundImage"), i = sessionStorage.getItem("ButtonText"), j = sessionStorage.getItem("ButtonTextColor"), k = sessionStorage.getItem("ButtonBackground"), l = sessionStorage.getItem("ButtonLink"), m = "visible", n = "iconHolderForBanner", o = sessionStorage.getItem("initialIconImage"); void 0 !== l && "" != l && null !== l || (m = "hidden"), h = void 0 === h || "" == h || null === h ? "../Logos/MarketingInformation/" + sessionStorage.getItem("initialBackGroundImage") : "/shared/images/logonimages/" + h, void 0 !== a && "" != a && null !== a || void 0 !== o && "" != o && null !== o ? void 0 === a || "" == a || null === a ? a = "../Logos/MarketingInformation/icons/" + o : void 0 !== o && "" != o && null !== o || (a = "/shared/images/logonimages/" + a) : n = "hideElement"; var p = '<ul id="bxSlider"><li><div class="contentHolder"><span><img id="icon" class="' + n + '"src="' + a + '" /> </span><span class="content-title" style="color:#' + c + ';">' + b + '</span><div class="content-description"><p class="title" style="color:#' + e + '">' + d + '</p><p class="copy" style="color:#' + g + ';">' + f + '</p><a class="banner-button" href="' + l + '" target="_blank" style="color:#' + j + "; background-color:#" + k + "; visibility:" + m + ';">' + i + '</a></div></div><img class="sliderImage lazy" src="' + h + '" /></li></ul>'; $("#previewRequest").html(p), $(".ui-icon-closethick").click(function () { sessionStorage.clear() }) }, PageLoadfunctionsForSliders: function () { function a(a, b) { var c, b = b || 50; return function () { var d = this, e = arguments; clearTimeout(c), c = setTimeout(function () { a.apply(d, Array.prototype.slice.call(e)) }, b) } } $("#bxSlider li").length >= 1 || window.location.search.indexOf("previewId") == -1 || SEL.Logon.PreviewRequestHandler(), $(".preLoaderDiv").hide(); var b = $("#bxSlider").bxSlider({ controls: !0, infiniteLoop: !0, hideControlOnEnd: !0, randomStart: !0, startSlide: 0, pager: $("#bxSlider li").length > 1, onSliderLoad: function () { $("#bannerHolder").css("visibility", "visible"), 1 == $("#bxSlider li").length && ($("#right").addClass("reduce-width"), $(".page-wrapper").width() > $("#right").width() + $("#left").width() + 20 && $("#bxSlider li").width($("#right").width() + ($(".page-wrapper").width() - ($("#right").width() + $("#left").width())))), $(".slider-container-ie .bx-viewport").attr("style", "height:" + $(window).height() + "px !important").addClass("slider-container-ie"), SEL.Logon.AlignModals(), $(".contentHolder").each(function () { var a = $("#right").height() - $(this).height() - $("#titlebar").height() + 40; $(this).css("top", a / 2) }) } }); this.alignWrapperOverResize = SEL.Logon.ReInitializeWrapper(b), $(window).resize(a(function (a) { this.alignWrapperOverResize = void 0, this.alignWrapperOverResize = SEL.Logon.ReInitializeWrapper(b), setTimeout(function () { $("#right").width() > $("#bxSlider li").width() + 25 && (this.alignWrapperOverResize = void 0, this.alignWrapperOverResize = SEL.Logon.ReInitializeWrapper(b)) }, 200) })) } } } var a = "Logon"; window.Sys && window.Sys.loader ? window.Sys.loader.registerScript(a, null, b) : b() }();