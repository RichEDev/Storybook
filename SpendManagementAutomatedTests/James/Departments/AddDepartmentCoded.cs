//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.3074
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace SpendManagement.AutomatedTests {
    using System;
    using System.Collections.Generic;
    using System.Text;
    using Microsoft.VisualStudio.TestTools.WebTesting;
    using Microsoft.VisualStudio.TestTools.WebTesting.Rules;
    
    
    public class AddDepartmentCoded : WebTest {
        
        public AddDepartmentCoded() {
            this.PreAuthenticate = true;
        }
        
        public override IEnumerator<WebTestRequest> GetRequestEnumerator() {
            // Initialize validation rules that apply to all requests in the WebTest
            if ((this.Context.ValidationLevel >= Microsoft.VisualStudio.TestTools.WebTesting.ValidationLevel.Low)) {
                ValidateResponseUrl validationRule1 = new ValidateResponseUrl();
                this.ValidateResponse += new EventHandler<ValidationEventArgs>(validationRule1.Validate);
            }

            WebTestRequest request1 = new WebTestRequest("https://www2.sel-expenses.com/");
            request1.ThinkTime = 11;
            request1.ExpectedResponseUrl = "https://www2.sel-expenses.com/shared/logon.aspx?ReturnUrl=%2fdefault.aspx";
            ExtractHiddenFields extractionRule1 = new ExtractHiddenFields();
            extractionRule1.Required = true;
            extractionRule1.HtmlDecode = true;
            extractionRule1.ContextParameterName = "1";
            request1.ExtractValues += new EventHandler<ExtractionEventArgs>(extractionRule1.Extract);
			yield return request1;
            request1 = null;

            WebTestRequest request2 = new WebTestRequest("https://www2.sel-expenses.com/shared/logon.aspx");
            request2.Method = "POST";
            request2.ExpectedResponseUrl = "https://www2.sel-expenses.com/home.aspx";
            request2.QueryStringParameters.Add("ReturnUrl", "%2fdefault.aspx", false, false);
            FormPostHttpBody request2Body = new FormPostHttpBody();
            request2Body.FormPostParameters.Add("__EVENTTARGET", this.Context["$HIDDEN1.__EVENTTARGET"].ToString());
            request2Body.FormPostParameters.Add("__EVENTARGUMENT", this.Context["$HIDDEN1.__EVENTARGUMENT"].ToString());
            request2Body.FormPostParameters.Add("__VIEWSTATE", this.Context["$HIDDEN1.__VIEWSTATE"].ToString());
            request2Body.FormPostParameters.Add("ctl00$pageContents$txtCompanyID", "sel_test");
            request2Body.FormPostParameters.Add("ctl00$pageContents$txtUsername", "james");
            request2Body.FormPostParameters.Add("ctl00$pageContents$txtPassword", "Password1");
            request2Body.FormPostParameters.Add("hiddenInputToUpdateATBuffer_CommonToolkitScripts", "1");
            request2Body.FormPostParameters.Add("ctl00$pageContents$btnLogon.x", "38");
            request2Body.FormPostParameters.Add("ctl00$pageContents$btnLogon.y", "14");
            request2.Body = request2Body;
			yield return request2;
            request2 = null;

            WebTestRequest request3 = new WebTestRequest("https://www2.sel-expenses.com/adminmenu.aspx");
            request3.ThinkTime = 5;
			yield return request3;
            request3 = null;

            WebTestRequest request4 = new WebTestRequest("https://www2.sel-expenses.com/categorymenu.aspx");
            request4.ThinkTime = 4;
			yield return request4;
            request4 = null;

            WebTestRequest request5 = new WebTestRequest("https://www2.sel-expenses.com/shared/admin/admindepartments.aspx");
			yield return request5;
            request5 = null;

            WebTestRequest request6 = new WebTestRequest("https://urs.microsoft.com/urs.asmx");
            request6.ThinkTime = 242;
            request6.Method = "POST";
            request6.Headers.Add(new WebTestRequestHeader("SOAPAction", "\"http://Microsoft.STS.STSWeb/Lookup\""));
            request6.QueryStringParameters.Add("MSPRU-Client-Key", "FHKb9JQ06W8SSMZlUwCSzw%3d%3d", false, false);
            request6.QueryStringParameters.Add("MSPRU-Patented-Lock", "QnViOCrYYDI%3d", false, false);
            StringHttpBody request6Body = new StringHttpBody();
            request6Body.ContentType = "text/xml; charset=utf-8";
            request6Body.InsertByteOrderMark = false;
            request6Body.BodyString = @"<soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soapenc=""http://schemas.xmlsoap.org/soap/encoding/""><soap:Body><Lookup xmlns=""http://Microsoft.STS.STSWeb/""><r soapenc:arrayType=""xsd:string[1]""><string>https://www2.sel-expenses.com/shared/admin/admindepartments.aspx</string></r><ID>{B3BB5BBA-E7D5-40AB-A041-A5B1C0B26C8F}</ID><v soapenc:arrayType=""xsd:string[5]""><string>7.0.6004.6</string><string>7.00.5730.11</string><string>7.0.6001.18000</string><string>6.0.6001.1.0</string><string>en-gb</string></v></Lookup></soap:Body></soap:Envelope>";
            request6.Body = request6Body;
			yield return request6;
            request6 = null;

            WebTestRequest request7 = new WebTestRequest("https://www2.sel-expenses.com/shared/admin/aedepartment.aspx");
            ExtractHiddenFields extractionRule2 = new ExtractHiddenFields();
            extractionRule2.Required = true;
            extractionRule2.HtmlDecode = true;
            extractionRule2.ContextParameterName = "1";
            request7.ExtractValues += new EventHandler<ExtractionEventArgs>(extractionRule2.Extract);
			yield return request7;
            request7 = null;

            WebTestRequest request8 = new WebTestRequest("https://urs.microsoft.com/urs.asmx");
            request8.ThinkTime = 11;
            request8.Method = "POST";
            request8.Headers.Add(new WebTestRequestHeader("SOAPAction", "\"http://Microsoft.STS.STSWeb/Lookup\""));
            request8.QueryStringParameters.Add("MSPRU-Client-Key", "jdblTn41sYy7LTeukPljdg%3d%3d", false, false);
            request8.QueryStringParameters.Add("MSPRU-Patented-Lock", "KcoHUKqCnU8%3d", false, false);
            StringHttpBody request8Body = new StringHttpBody();
            request8Body.ContentType = "text/xml; charset=utf-8";
            request8Body.InsertByteOrderMark = false;
            request8Body.BodyString = @"<soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soapenc=""http://schemas.xmlsoap.org/soap/encoding/""><soap:Body><Lookup xmlns=""http://Microsoft.STS.STSWeb/""><r soapenc:arrayType=""xsd:string[1]""><string>https://www2.sel-expenses.com/shared/admin/aedepartment.aspx</string></r><ID>{B3BB5BBA-E7D5-40AB-A041-A5B1C0B26C8F}</ID><v soapenc:arrayType=""xsd:string[5]""><string>7.0.6004.6</string><string>7.00.5730.11</string><string>7.0.6001.18000</string><string>6.0.6001.1.0</string><string>en-gb</string></v></Lookup></soap:Body></soap:Envelope>";
            request8.Body = request8Body;
			yield return request8;
            request8 = null;

            WebTestRequest request9 = new WebTestRequest("https://www2.sel-expenses.com/shared/admin/aedepartment.aspx");
            request9.Method = "POST";
            request9.ExpectedResponseUrl = "https://www2.sel-expenses.com/shared/admin/admindepartments.aspx";
            FormPostHttpBody request9Body = new FormPostHttpBody();
            request9Body.FormPostParameters.Add("__EVENTTARGET", this.Context["$HIDDEN1.__EVENTTARGET"].ToString());
            request9Body.FormPostParameters.Add("__EVENTARGUMENT", this.Context["$HIDDEN1.__EVENTARGUMENT"].ToString());
            request9Body.FormPostParameters.Add("__VIEWSTATE", this.Context["$HIDDEN1.__VIEWSTATE"].ToString());
            request9Body.FormPostParameters.Add("ctl00$contentmain$txtdepartment", "Test");
            request9Body.FormPostParameters.Add("ctl00$contentmain$vcDepartment_ClientState", this.Context["$HIDDEN1.ctl00$contentmain$vcDepartment_ClientState"].ToString());
            request9Body.FormPostParameters.Add("ctl00$contentmain$txtdescription", "Description");
            request9Body.FormPostParameters.Add("hiddenInputToUpdateATBuffer_CommonToolkitScripts", "1");
            request9Body.FormPostParameters.Add("ctl00$contentmain$cmdok.x", "25");
            request9Body.FormPostParameters.Add("ctl00$contentmain$cmdok.y", "17");
            request9.Body = request9Body;
			yield return request9;
            request9 = null;
        }
    }
}
